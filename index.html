<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ú—è—Å–æ –¥–ª—è —Å–æ–±–∞–∫</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body { margin:0; font-family:Arial; background:#f2f2f7; padding-bottom:120px; }
header { padding:16px; font-size:22px; font-weight:700; }
.products { padding:16px; display:grid; gap:16px; }
.card { background:#fff; border-radius:16px; overflow:hidden; }
.card img { width:100%; height:180px; object-fit:cover; }
.card-content { padding:14px; }
.qty { display:flex; gap:10px; margin-top:10px; }
.qty button { width:36px; height:36px; border:none; border-radius:8px; }
.checkout { position:fixed; bottom:0; left:0; right:0; background:#fff; padding:14px; }
.checkout button { width:100%; padding:14px; font-size:16px; background:#34c759; color:#fff; border:none; border-radius:12px; }
</style>
</head>

<body>

<header>üê∂ –ú–∞–≥–∞–∑–∏–Ω –º—è—Å–∞ –¥–ª—è —Å–æ–±–∞–∫</header>

<div style="padding:16px; display:flex; gap:10px;">
  <button onclick="filter='all'; render()">–í—Å–µ</button>
  <button onclick="filter='meat'; render()">ü•© –ú—è—Å–æ</button>
  <button onclick="filter='sub'; render()">üß† –°—É–±–ø—Ä–æ–¥—É–∫—Ç—ã</button>
</div>

<div class="products" id="products"></div>

<div style="padding:16px">
  <input id="phone" placeholder="üìû –¢–µ–ª–µ—Ñ–æ–Ω" style="width:100%; padding:12px; margin-bottom:8px;">
  <input id="address" placeholder="üìç –ê–¥—Ä–µ—Å" style="width:100%; padding:12px;">
</div>

<div class="checkout">
  <button onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ (<span id="total">0</span> ‚ÇΩ)</button>
</div>

<script>
const tg = window.Telegram.WebApp;
tg.expand();

let filter = "all";
const cart = {};

const items = [
  { id:"beef", name:"–ì–æ–≤—è–¥–∏–Ω–∞", price:500, category:"meat", img:"https://i.imgur.com/8Q1ZQZQ.jpg" },
  { id:"chicken", name:"–ö—É—Ä–∏—Ü–∞", price:260, category:"meat", img:"https://i.imgur.com/4n2k7eP.jpg" },
  { id:"heart", name:"–°–µ—Ä–¥—Ü–µ", price:300, category:"sub", img:"https://i.imgur.com/F7yFQpP.jpg" },
  { id:"liver", name:"–ü–µ—á–µ–Ω—å", price:180, category:"sub", img:"https://i.imgur.com/HRn6Fz5.jpg" }
];

function render(){
  const root = document.getElementById("products");
  root.innerHTML = "";
  items.filter(i => filter==="all" || i.category===filter)
    .forEach(i=>{
      const q = cart[i.id]||0;
      root.innerHTML += `
        <div class="card">
          <img src="${i.img}">
          <div class="card-content">
            <b>${i.name}</b><br>${i.price} ‚ÇΩ / –∫–≥
            <div class="qty">
              <button onclick="add('${i.id}',-1)">‚àí</button>
              <b>${q} –∫–≥</b>
              <button onclick="add('${i.id}',1)">+</button>
            </div>
          </div>
        </div>`;
    });
  document.getElementById("total").innerText = total();
}

function add(id,d){ cart[id]=Math.max(0,(cart[id]||0)+d); render(); }
function total(){ return items.reduce((s,i)=>s+(cart[i.id]||0)*i.price,0); }

function checkout(){
  const phone = phoneInput.value.trim();
  const address = addressInput.value.trim();
  if(!phone||!address||!total()) return tg.showAlert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ");

  const order = items.filter(i=>cart[i.id]).map(i=>({
    name:i.name, kg:cart[i.id], price:i.price, sum:cart[i.id]*i.price
  }));

  tg.sendData(JSON.stringify({ phone, address, order, total: total() }));
  tg.showAlert("–°–ø–∞—Å–∏–±–æ! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏.");
  setTimeout(()=>tg.close(),800);
}

const phoneInput = document.getElementById("phone");
const addressInput = document.getElementById("address");
render();
</script>

</body>
</html>
